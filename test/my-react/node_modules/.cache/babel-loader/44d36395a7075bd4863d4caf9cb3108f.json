{"ast":null,"code":"var _jsxFileName = \"/workspace/react-analysis/test/my-react/src/component/One.js\";\nimport React, { Component } from 'react';\nimport { unstable_scheduleCallback } from 'scheduler';\nimport { flushSync } from 'react-dom';\n\nclass One extends Component {\n  constructor(option) {\n    super(option);\n\n    this.initItems = num => {\n      let len = num;\n      let arr = [];\n\n      for (let i = 0; i < len; i++) {\n        let obj = {};\n        obj['key'] = parseInt(Math.random() * len);\n        arr.push(obj);\n      }\n\n      return arr;\n    };\n\n    this.changeItem = () => {\n      let len = this.state.items.length == 200 ? 40000 : 200;\n      var arr = this.initItems(len);\n      let start = Date.now();\n      unstable_scheduleCallback(() => {\n        this.setState({\n          items: arr\n        }, function () {\n          let end = Date.now();\n          console.log('change 时长 ：' + (end - start));\n        });\n      });\n    };\n\n    this.changeName = () => {\n      let name = this.state.name;\n      let start = Date.now(); // flushSync(() => {\n\n      this.setState({\n        name: name + 'e'\n      }, function () {\n        let end = Date.now();\n        console.log('change name 时长 ：' + (end - start));\n      }); // })\n    };\n\n    this.state = {\n      name: 'one',\n      age: 0,\n      items: []\n    };\n  }\n\n  componentDidMount() {\n    let arr = this.initItems(200);\n    let start = Date.now();\n    this.setState({\n      items: arr\n    }, function () {\n      let end = Date.now();\n      console.log(\"init 时长 ：\" + (end - start));\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      onClick: this.changeName,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, \"one name is \", this.state.name), React.createElement(\"p\", {\n      onClick: this.changeItem,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }, \"change item\"), this.state.items.map((val, index) => {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, val['key']));\n    }));\n  }\n\n}\n\nexport default One;","map":{"version":3,"sources":["/workspace/react-analysis/test/my-react/src/component/One.js"],"names":["React","Component","unstable_scheduleCallback","flushSync","One","constructor","option","initItems","num","len","arr","i","obj","parseInt","Math","random","push","changeItem","state","items","length","start","Date","now","setState","end","console","log","changeName","name","age","componentDidMount","render","map","val","index"],"mappings":"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","sourcesContent":["import React, {Component } from 'react'\nimport {unstable_scheduleCallback} from 'scheduler';\nimport {flushSync} from 'react-dom'\n\nclass One extends Component{\n    constructor (option) {\n        super(option);\n        this.state = {\n            name : 'one',\n            age : 0,\n            items : []\n        };\n    }\n\n    initItems = (num) => {\n        let len = num\n        let arr = []\n        for (let i = 0; i < len; i ++) {\n            let obj = {}\n            obj['key'] = parseInt(Math.random() * len)\n            arr.push(obj)\n        }\n        return arr\n    }\n\n    componentDidMount() {\n        let arr = this.initItems(200)\n        let start = Date.now()\n        this.setState({\n            items : arr\n        },function(){\n            let end = Date.now()\n            console.log(\"init 时长 ：\" + (end - start))\n        })\n    }\n\n    changeItem = () => {\n        let len = this.state.items.length == 200 ? 40000 : 200\n        var arr = this.initItems(len);\n        let start = Date.now()\n        unstable_scheduleCallback(() => {\n            this.setState({\n                items : arr\n            },function(){\n                let end = Date.now()\n                console.log('change 时长 ：' + (end - start))\n            })\n        })\n    }\n\n    changeName = () => {\n        let name = this.state.name\n        let start = Date.now()\n        // flushSync(() => {\n            this.setState({\n                name : name + 'e'\n            },function(){\n                let end = Date.now()\n            console.log('change name 时长 ：' + (end - start))\n            })\n        // })\n    }\n\n    render () {\n        return (\n            <div>\n                <h1 onClick={this.changeName}>one name is {this.state.name}</h1>\n                <p onClick={this.changeItem}>change item</p>\n                {\n                    this.state.items.map((val,index) => {\n                        return (<div><div>{val['key']}</div></div>)\n                    })\n                }\n            </div>\n        )\n    }\n}\n\nexport default One;"]},"metadata":{},"sourceType":"module"}